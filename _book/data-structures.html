<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Data Structures | Urban Informatics Toolkit</title>
  <meta name="description" content="A hands on introduction approach to analyzing the urban Commons." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Data Structures | Urban Informatics Toolkit" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A hands on introduction approach to analyzing the urban Commons." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Data Structures | Urban Informatics Toolkit" />
  
  <meta name="twitter:description" content="A hands on introduction approach to analyzing the urban Commons." />
  

<meta name="author" content="Josiah Parry" />


<meta name="date" content="2020-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualizing-trends-and-relationships.html"/>
<link rel="next" href="summary-statistics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Urban Informatics Toolkit</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="the-basics.html"><a href="the-basics.html"><i class="fa fa-check"></i><b>2</b> The basics</a></li>
<li class="chapter" data-level="3" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html"><i class="fa fa-check"></i><b>3</b> R as a calculator</a></li>
<li class="part"><span><b>I Toolkit Foundations</b></span></li>
<li class="chapter" data-level="4" data-path="visual-analysis.html"><a href="visual-analysis.html"><i class="fa fa-check"></i><b>4</b> Visual Analysis</a></li>
<li class="chapter" data-level="5" data-path="schools-of-urban-informatics.html"><a href="schools-of-urban-informatics.html"><i class="fa fa-check"></i><b>5</b> Schools of Urban Informatics</a></li>
<li class="chapter" data-level="6" data-path="broken-windows-and-the-origin-of-ecometrics.html"><a href="broken-windows-and-the-origin-of-ecometrics.html"><i class="fa fa-check"></i><b>6</b> Broken Windows and the origin of Ecometrics</a></li>
<li class="chapter" data-level="7" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>7</b> Reading data</a></li>
<li class="chapter" data-level="8" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html"><i class="fa fa-check"></i><b>8</b> General data manipulation</a></li>
<li class="chapter" data-level="9" data-path="visualizing-trends-and-relationships.html"><a href="visualizing-trends-and-relationships.html"><i class="fa fa-check"></i><b>9</b> Visualizing Trends and Relationships</a></li>
<li class="chapter" data-level="10" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>10</b> Data Structures</a></li>
<li class="chapter" data-level="11" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>11</b> Summary statistics</a></li>
<li class="chapter" data-level="12" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>12</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="13" data-path="summarizing-the-tidy-way.html"><a href="summarizing-the-tidy-way.html"><i class="fa fa-check"></i><b>13</b> summarizing the tidy way</a></li>
<li class="chapter" data-level="14" data-path="i-have-two-datasets-what-now.html"><a href="i-have-two-datasets-what-now.html"><i class="fa fa-check"></i><b>14</b> I have two datasets, what now?</a></li>
<li class="chapter" data-level="15" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>15</b> Spatial Analysis</a></li>
<li class="chapter" data-level="16" data-path="creating-ecometrics.html"><a href="creating-ecometrics.html"><i class="fa fa-check"></i><b>16</b> Creating Ecometrics</a></li>
<li class="part"><span><b>II Case Studies</b></span></li>
<li class="chapter" data-level="17" data-path="case-study-twitter-data.html"><a href="case-study-twitter-data.html"><i class="fa fa-check"></i><b>17</b> Case Study: Twitter Data</a></li>
<li class="divider"></li>
<li><a href="https://github.com/josiahparry/urban-informatics-toolkit" target="blank">GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Urban Informatics Toolkit</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-structures" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Data Structures</h1>
<p>There is a topic I have been skirting around for some time now and I think it is time that we have to have a rather important conversation. It’s one that is almost never fun but is quite necessary because without it, there may be many painful lessons learned in the future. We’re going to spend this next chapter talking about data structures—but not all of them! We’ll only cover the three most common and, by the end of this, it is my hope you will have a much stronger idea of <em>what</em> you are working with and <em>why</em> it behaves the way it does.</p>
<p>We will cover vectors, data frames rather briefly, and lists. We’ll talk about some of their defining characteristics and how we can interact with them. Often the theory behind these object types are ommitted, but I am of the mind that learning this early on will pay off in dividends. Take a deep breath before we dive in and remind yourself that it ain’t nothin’ but a thing.</p>
<p>This section is undoubtedly the most theoretically dense from a software perspective of this entire book. These concepts may be a little bit difficult to grasp at the frist go around particularly if you do not have a programming background. But do not be discouraged! This is tough and there is no way to around it. If you can grasp this chapter programming in R will become so much easier. You will develop an intuition of why certain things happen to your data and how to interact with other data structures.</p>
<div id="atomic-vectors" class="section level2">
<h2><span class="header-section-number">10.1</span> Atomic Vectors</h2>
<p>I like to think of the atomic vector as the building block of any R object. You’ve actually been working with atomic vectors this entire time. But we haven’t been very explicit about this yet. Up until this point we have been working mainly with tibbles. Each column of a tibble is <em>actually</em> an atomic vector.</p>
<p>What makes a vector a atomic is that it can only be <strong>a single data type</strong> and that they are <em>one-dimensional</em>—opposed to tibbles which are two-dimensional (<a href="https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/" class="uri">https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/</a>). You may have noticed that every value of a column is of the same data type. This means that they are rather strict to work with and for good reason. Imagine you wanted to multiple a column by 10, what would happen if a few of the values in the column were actually written out as text? Let’s try exploring this idea.</p>
<p>The most common way to create a vector in R is to use the <code>c()</code> function. This stands for <em>combine</em>. We can <code>c</code>ombine as many elements as we want into a single vector using <code>c()</code>. Each element of the vector is it’s own argument (separated by a comma).</p>
<p>For example if we wanted to create a vector of <a href="https://data.bls.gov/timeseries/LAUMT257165000000003?amp%253bdata_tool=XGtable&amp;output_view=data&amp;include_graphs=true">Boston’s unemployment rate</a> rate for each month in 2019 that we have data for (until October as of this writing on 2019-12-18) we could write the below. We will save it in a a vector called <code>unemp</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">unemp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.2</span>, <span class="fl">2.8</span>, <span class="fl">2.8</span>, <span class="fl">2.4</span>, <span class="fl">2.8</span>, <span class="fl">2.9</span>, <span class="fl">2.7</span>, <span class="fl">2.6</span>, <span class="fl">2.7</span>, <span class="fl">2.3</span>)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">unemp</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3</span></a></code></pre></div>
<p>What is really great about vectors is that we can perform any number of operations on them—i.e. find the sum of all the values, the average, add a value to each element, etc.</p>
<p>If we wanted to find the average unemployment rate for Boston for Jan - Oct. 2019, we can supply the vector to the function <code>mean()</code>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">mean</span>(unemp)</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="co">## [1] 2.72</span></a></code></pre></div>
<p>However, you may be thinking “there are 12 months in a year not 10 and that should be represented” and if you are, I totally agree with you. Since the data for November and December are missing, we should denote that and update <code>unemp</code> accordingly. R uses <code>NA</code> to represent missing data. To represent this we can append two <code>NA</code>s to the vector we have. There are two ways we can do this. We can either combine <code>unemp</code> with two <code>NA</code>s, or rewrite the above vector.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="co"># combining existing with 2 NAs</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="kw">c</span>(unemp, <span class="ot">NA</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3  NA  NA</span></a></code></pre></div>
<p>This works, but since we will be saving this to <code>unemp</code> again it is not best practices to use the variable you are changing in that objects assignment.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="co"># for example</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2">unemp &lt;-<span class="st"> </span><span class="kw">c</span>(unemp, <span class="ot">NA</span>, <span class="ot">NA</span>)</a></code></pre></div>
<p>The above is rather unclear and might confuse someone that will have to read your code at a later time—that person may even be you. For this reason we will redefine it.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">unemp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.2</span>, <span class="fl">2.8</span>, <span class="fl">2.8</span>, <span class="fl">2.4</span>, <span class="fl">2.8</span>, <span class="fl">2.9</span>, <span class="fl">2.7</span>, <span class="fl">2.6</span>, <span class="fl">2.7</span>, <span class="fl">2.3</span>, <span class="ot">NA</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2">unemp</a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3  NA  NA</span></a></code></pre></div>
<p>We know that there are 12 elements in this vector, but sometimes it is quite nice to sanity check oneself. We can always find out how long (or how many elements are in) a vector is by supplying the vector to the <code>length()</code> function.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="co"># how many observations are in `unemp`?</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">length</span>(unemp)</a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="co">## [1] 12</span></a></code></pre></div>
<p>There are a total of six types of vectors. Fortunately, only four of these really matter to us. These are <code>integer</code>, <code>double</code>, <code>character</code>, <code>logical</code>.</p>
<p>Integers represent whole numbers. To specify an integer we append an <code>L</code> after the number such as <code>20L</code>. Doubles are any number that requires any precision aka decimal places. You can specify doubles in a number of formats such as scientific notation. Generally the easiest way to do this, though, is using a decimal. Together integers and doubles are lumped into the category of numeric. This is because, well, they are numbers.</p>
<p>As you learned previously, character vectors are created with the use of quotation marks; either <code>&quot;</code> or <code>'</code>.</p>
<p>We’ve already created a vector of type double, <code>unemp</code>. You can check what type of vector <code>unemp</code> is with <code>typeof()</code></p>
<blockquote>
<p>Note: <code>typeof()</code> is used only for internal R object such as lists and vectors. In most cases you will want to use <code>class()</code> to return the class of an object.</p>
</blockquote>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw">typeof</span>(unemp)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="co">## [1] &quot;double&quot;</span></a></code></pre></div>
<p>Say we create another vector called <code>month</code> with the numbers 1 through 12.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">month &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="kw">typeof</span>(month)</a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="co">## [1] &quot;double&quot;</span></a></code></pre></div>
<p>Notice that since we didn’t specify the <code>L</code> after the numbers R defaulted to treating <code>month</code> as a double. When possible it is good to make the distinction between integer and numeric.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">month &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 9L, 10L, 11L, 12L)</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"></a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="kw">typeof</span>(month)</a>
<a class="sourceLine" id="cb88-4" data-line-number="4"><span class="co">## [1] &quot;integer&quot;</span></a></code></pre></div>
<p>R has a number of vectors that are built in these being the letters of the alphabet (<code>letters</code> and <code>LETTERS</code> respectively), as well as <code>month.abb</code>, <code>month.name</code>, and <code>pi</code>. <code>month.name</code> is already available to us so let’s not recreate it.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">month.name</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="co">##  [1] &quot;January&quot;   &quot;February&quot;  &quot;March&quot;     &quot;April&quot;     &quot;May&quot;      </span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="co">##  [6] &quot;June&quot;      &quot;July&quot;      &quot;August&quot;    &quot;September&quot; &quot;October&quot;  </span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="co">## [11] &quot;November&quot;  &quot;December&quot;</span></a>
<a class="sourceLine" id="cb89-5" data-line-number="5"></a>
<a class="sourceLine" id="cb89-6" data-line-number="6"><span class="kw">typeof</span>(month.name)</a>
<a class="sourceLine" id="cb89-7" data-line-number="7"><span class="co">## [1] &quot;character&quot;</span></a></code></pre></div>
<p>Notice the quotes around each vector element. This is how we identify character vectors.</p>
<p>Logical vectors are the last kind of vector we need to go over. Logical vectors are represented as the values <code>TRUE</code> and <code>FALSE</code>. Simple enough. Onward!</p>
<p>Recall that vectors are atomic meaning that there can only be one type per vector and we cannot mix and match. When a character is in the presence of another element of a different type, that value is <em><strong>coerced</strong></em> into a character. Coersion is the process of implicitly or contextually changing an object from one type to another. For example:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"></a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="kw">typeof</span>(x)</a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="co">## [1] &quot;character&quot;</span></a></code></pre></div>
<p>Something similar happens when a logical value is in the presence of a numeric value</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="dv">1</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="co">## [1] 1 1 0</span></a></code></pre></div>
<p>In the presence of a numeric value <code>TRUE</code> becomes equal to <code>1L</code> and <code>FALSE</code> equal to <code>0L</code>.This behavior exists whenever a logical value is presented where a numeric is expected such as the function call below.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="kw">sum</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="co">## [1] 1</span></a></code></pre></div>
<p>While coersion occurs from other processes like combining values in a vector, <em>casting</em> is the process of intentionally changing an object’s class. There are a number of casting functions whice generaly take the shape of <code>as.class()</code> or <code>as_class()</code>. Each of the vector types covered have their own casting functions.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">as.integer</span>(<span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co">## [1] 1</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="kw">as.character</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="co">## [1] &quot;123&quot;</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="kw">as.double</span>(<span class="st">&quot;2.331&quot;</span>)</a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="co">## [1] 2.331</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="kw">as.logical</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb93-8" data-line-number="8"><span class="co">## [1] FALSE</span></a></code></pre></div>
<p>As you progress in your R journey you will find scenarios in which you need to cast objects from one class to another and these functions are the trick.</p>
<p>You now have a strong understanding of the underbellies of R vectors. One thing that is missing is an understanding of how we can select subsets from vectors. To extract a value from vectors we append square brackets at the end of the vector <code>vec[]</code>. We supply an index value to the square brackets to receive the value at that position</p>
<p>To select the month of January from the <code>unemp</code> vector, the first element, we provide the value of <code>1</code> to the brackets.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">unemp[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="co">## [1] 3.2</span></a></code></pre></div>
<p>To extract more than one value, we provide a vector of the row indexes we desire.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">unemp[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="co">## [1] 3.2 2.8</span></a></code></pre></div>
<p>There is yet another way to extract values from these vectors. We can provide a logical vector to our square brackets. For example, we can identify every value of <code>unemp</code> that is above the average rate.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="co"># find average removing missing values</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2">avg_unemp &lt;-<span class="st"> </span><span class="kw">mean</span>(unemp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb96-3" data-line-number="3"></a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="co"># identify which values are above average</span></a>
<a class="sourceLine" id="cb96-5" data-line-number="5">index &lt;-<span class="st"> </span>unemp <span class="op">&gt;</span><span class="st"> </span>avg_unemp</a>
<a class="sourceLine" id="cb96-6" data-line-number="6"></a>
<a class="sourceLine" id="cb96-7" data-line-number="7">index</a>
<a class="sourceLine" id="cb96-8" data-line-number="8"><span class="co">##  [1]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE    NA</span></a>
<a class="sourceLine" id="cb96-9" data-line-number="9"><span class="co">## [12]    NA</span></a></code></pre></div>
<p>Notice that the <code>NA</code>s stayed <code>NA</code>? They can be pesky. Hadley writes in Advanced R “missing values tend to be infectious: most computations involving a missing value will return another missing value.” (<a href="https://adv-r.hadley.nz/vectors-chap.html" class="uri">https://adv-r.hadley.nz/vectors-chap.html</a>)</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">unemp[index]</a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="co">## [1] 3.2 2.8 2.8 2.8 2.9  NA  NA</span></a></code></pre></div>
<p>How annoying those NAs can be! To prevent these NAs from showing upwe can add another condition to our <code>index</code> line to remove NAs. Like there are <code>as.*()</code> functions for casting, there are also <code>is.*()</code> functions for testing. <code>is.*()</code> returns a logical vector of the same length as the provided vector.</p>
<blockquote>
<p>Note: the <code>*</code> is called a wildcard. The wildcard character comes from SQL and when present means that any string can follow. <code>is.*()</code> is intended to indicate any possible testing function such as <code>is.numeric()</code>, <code>is_tibble()</code>, etc.</p>
</blockquote>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw">is.na</span>(unemp)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="co">##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</span></a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="co">## [12]  TRUE</span></a></code></pre></div>
<p>As we learned, we can negate logical vectors with an <code>!</code>. We can negate the test results and include an an <code>&amp;</code> condition to only identify unemployment values above average <em>and</em> aren’t missing.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">index &lt;-<span class="st"> </span>unemp <span class="op">&gt;</span><span class="st"> </span>avg_unemp <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(unemp)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"></a>
<a class="sourceLine" id="cb99-3" data-line-number="3">unemp[index]</a>
<a class="sourceLine" id="cb99-4" data-line-number="4"><span class="co">## [1] 3.2 2.8 2.8 2.8 2.9</span></a></code></pre></div>
<p>There is one last thing to keep in mind and with subsetting vectors using a logical vector that is of a different length. When you use a logical vector to subset and they are of differing length, the logical vector will be recycled for the remaining values of the vector being subset. As always, an example will be the best.</p>
<p>Say we have an object called <code>x</code> which are the values from 0 to 10 and an <code>index</code> to subset with. If we subset it with <code>index</code> and <code>index</code> is a logical vector of length two with the values of <code>TRUE</code> and <code>FALSE</code>, every other observation will be returned. This is because come the third value in <code>x</code>, R has ran out of values in <code>index</code> to use so it goes back to the beginning</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb100-2" data-line-number="2">x</a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="co">##  [1]  0  1  2  3  4  5  6  7  8  9 10</span></a></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">index &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"></a>
<a class="sourceLine" id="cb101-3" data-line-number="3">x[index]</a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="co">## [1]  0  2  4  6  8 10</span></a></code></pre></div>
<p>And what happens when the only value is a single logical value?</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">x[<span class="ot">TRUE</span>]</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="co">##  [1]  0  1  2  3  4  5  6  7  8  9 10</span></a></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1">x[<span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="co">## integer(0)</span></a></code></pre></div>
<p>In this latter case see how the output says <code>integer(0)</code>. This is informing you that the vector contains 0 elements.</p>
</div>
<div id="data-frames" class="section level2">
<h2><span class="header-section-number">10.2</span> Data Frames</h2>
<p>The entirety of the work in this book so far has been with <code>tibbles</code>. Tibbles are actually a special type of data frame. Data frames are R’s native way for storing rectangular data. Rectangles are two-dimensional, so are data frames.</p>
<p>Data frames are secretly just a bunch of vectors squished together. The important thing is that all vectors are of the same length. This ensures that each observation (row) has one value from each vector. Because of the nature of a data frame, each column must adhere to the rules of vectors.</p>
<p>Let’s create a tibble using the <code>unemp</code> vector and the <code>tibble()</code> function. <code>tibble()</code> works in a somewhat similar manner as <code>mutate()</code> where the arguments we provide are name value pairs. In the case of tibble, the argument take the form of <code>col_name = vector</code>.</p>
<p>We create a tibble with the unemployment rate below.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb104-4" data-line-number="4">  <span class="dt">unemp_rate =</span> unemp</a>
<a class="sourceLine" id="cb104-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb104-6" data-line-number="6"><span class="co">## # A tibble: 12 x 1</span></a>
<a class="sourceLine" id="cb104-7" data-line-number="7"><span class="co">##    unemp_rate</span></a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="co">##         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb104-9" data-line-number="9"><span class="co">##  1        3.2</span></a>
<a class="sourceLine" id="cb104-10" data-line-number="10"><span class="co">##  2        2.8</span></a>
<a class="sourceLine" id="cb104-11" data-line-number="11"><span class="co">##  3        2.8</span></a>
<a class="sourceLine" id="cb104-12" data-line-number="12"><span class="co">##  4        2.4</span></a>
<a class="sourceLine" id="cb104-13" data-line-number="13"><span class="co">##  5        2.8</span></a>
<a class="sourceLine" id="cb104-14" data-line-number="14"><span class="co">##  6        2.9</span></a>
<a class="sourceLine" id="cb104-15" data-line-number="15"><span class="co">##  7        2.7</span></a>
<a class="sourceLine" id="cb104-16" data-line-number="16"><span class="co">##  8        2.6</span></a>
<a class="sourceLine" id="cb104-17" data-line-number="17"><span class="co">##  9        2.7</span></a>
<a class="sourceLine" id="cb104-18" data-line-number="18"><span class="co">## 10        2.3</span></a>
<a class="sourceLine" id="cb104-19" data-line-number="19"><span class="co">## 11       NA  </span></a>
<a class="sourceLine" id="cb104-20" data-line-number="20"><span class="co">## 12       NA</span></a></code></pre></div>
<p>We can add the month name and create a new column to indicate if that month has a higher than average unemployment rate.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1">unemp_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb105-2" data-line-number="2">  <span class="dt">unemp_rate =</span> unemp, </a>
<a class="sourceLine" id="cb105-3" data-line-number="3">  <span class="dt">month =</span> month.name</a>
<a class="sourceLine" id="cb105-4" data-line-number="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb105-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">above_avg =</span> unemp_rate <span class="op">&gt;</span><span class="st"> </span>avg_unemp)</a>
<a class="sourceLine" id="cb105-6" data-line-number="6"></a>
<a class="sourceLine" id="cb105-7" data-line-number="7">unemp_tbl</a>
<a class="sourceLine" id="cb105-8" data-line-number="8"><span class="co">## # A tibble: 12 x 3</span></a>
<a class="sourceLine" id="cb105-9" data-line-number="9"><span class="co">##    unemp_rate month     above_avg</span></a>
<a class="sourceLine" id="cb105-10" data-line-number="10"><span class="co">##         &lt;dbl&gt; &lt;chr&gt;     &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb105-11" data-line-number="11"><span class="co">##  1        3.2 January   TRUE     </span></a>
<a class="sourceLine" id="cb105-12" data-line-number="12"><span class="co">##  2        2.8 February  TRUE     </span></a>
<a class="sourceLine" id="cb105-13" data-line-number="13"><span class="co">##  3        2.8 March     TRUE     </span></a>
<a class="sourceLine" id="cb105-14" data-line-number="14"><span class="co">##  4        2.4 April     FALSE    </span></a>
<a class="sourceLine" id="cb105-15" data-line-number="15"><span class="co">##  5        2.8 May       TRUE     </span></a>
<a class="sourceLine" id="cb105-16" data-line-number="16"><span class="co">##  6        2.9 June      TRUE     </span></a>
<a class="sourceLine" id="cb105-17" data-line-number="17"><span class="co">##  7        2.7 July      FALSE    </span></a>
<a class="sourceLine" id="cb105-18" data-line-number="18"><span class="co">##  8        2.6 August    FALSE    </span></a>
<a class="sourceLine" id="cb105-19" data-line-number="19"><span class="co">##  9        2.7 September FALSE    </span></a>
<a class="sourceLine" id="cb105-20" data-line-number="20"><span class="co">## 10        2.3 October   FALSE    </span></a>
<a class="sourceLine" id="cb105-21" data-line-number="21"><span class="co">## 11       NA   November  NA       </span></a>
<a class="sourceLine" id="cb105-22" data-line-number="22"><span class="co">## 12       NA   December  NA</span></a></code></pre></div>
<p>To interact with the underlying vector of a data frame we can use the dollar sign <code>$</code> operator. This takes the form of <code>tbl$col_name</code>.</p>
<p>For example, extracting the <code>unemp_rate</code> column looks like:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">unemp_tbl<span class="op">$</span>unemp_rate</a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3  NA  NA</span></a></code></pre></div>
<p>Note that the difference between <code>select(tbl, col)</code> and <code>tbl$col</code>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">select</span>(unemp_tbl, unemp_rate)</a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="co">## # A tibble: 12 x 1</span></a>
<a class="sourceLine" id="cb107-3" data-line-number="3"><span class="co">##    unemp_rate</span></a>
<a class="sourceLine" id="cb107-4" data-line-number="4"><span class="co">##         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb107-5" data-line-number="5"><span class="co">##  1        3.2</span></a>
<a class="sourceLine" id="cb107-6" data-line-number="6"><span class="co">##  2        2.8</span></a>
<a class="sourceLine" id="cb107-7" data-line-number="7"><span class="co">##  3        2.8</span></a>
<a class="sourceLine" id="cb107-8" data-line-number="8"><span class="co">##  4        2.4</span></a>
<a class="sourceLine" id="cb107-9" data-line-number="9"><span class="co">##  5        2.8</span></a>
<a class="sourceLine" id="cb107-10" data-line-number="10"><span class="co">##  6        2.9</span></a>
<a class="sourceLine" id="cb107-11" data-line-number="11"><span class="co">##  7        2.7</span></a>
<a class="sourceLine" id="cb107-12" data-line-number="12"><span class="co">##  8        2.6</span></a>
<a class="sourceLine" id="cb107-13" data-line-number="13"><span class="co">##  9        2.7</span></a>
<a class="sourceLine" id="cb107-14" data-line-number="14"><span class="co">## 10        2.3</span></a>
<a class="sourceLine" id="cb107-15" data-line-number="15"><span class="co">## 11       NA  </span></a>
<a class="sourceLine" id="cb107-16" data-line-number="16"><span class="co">## 12       NA</span></a></code></pre></div>
<p>The difference is that <code>$</code> returns the underlying vector whereas <code>select()</code> will always return another data frame. You now have the ability to both filter data and grab a subset of a vector. But we have yet to visit how to grab a single value from a data frame.</p>
<p>You could try something like</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">unemp_tbl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb108-4" data-line-number="4"><span class="co">## # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb108-5" data-line-number="5"><span class="co">##   unemp_rate</span></a>
<a class="sourceLine" id="cb108-6" data-line-number="6"><span class="co">##        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb108-7" data-line-number="7"><span class="co">## 1        2.3</span></a></code></pre></div>
<p>to grab the 10th value of the first column. But again, you still have a tibble and you are not able to use that directly like a standalone number.</p>
<p>We can again use brackets to subset the our R object. But data frames are two dimensional, so we need to specify the indexes in two dimensions. If you have made a hand drawn graph used a cartesian plane, which I assume you all have, this will is the same idea. With a cartesian plane we can identify any point with a combination of two values: x and y. x refers to the horizontal axis and y the vertical axis. When we put the cartesian plane in the same frame of reference as the rectangular data frame we envision our rows as the x and our columns as the y.</p>
<p>In specifying our index, we are able to select all rows or all columns by leaving the x or y spot empty respectively.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">unemp_tbl[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="co">## # A tibble: 12 x 1</span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="co">##    unemp_rate</span></a>
<a class="sourceLine" id="cb109-4" data-line-number="4"><span class="co">##         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb109-5" data-line-number="5"><span class="co">##  1        3.2</span></a>
<a class="sourceLine" id="cb109-6" data-line-number="6"><span class="co">##  2        2.8</span></a>
<a class="sourceLine" id="cb109-7" data-line-number="7"><span class="co">##  3        2.8</span></a>
<a class="sourceLine" id="cb109-8" data-line-number="8"><span class="co">##  4        2.4</span></a>
<a class="sourceLine" id="cb109-9" data-line-number="9"><span class="co">##  5        2.8</span></a>
<a class="sourceLine" id="cb109-10" data-line-number="10"><span class="co">##  6        2.9</span></a>
<a class="sourceLine" id="cb109-11" data-line-number="11"><span class="co">##  7        2.7</span></a>
<a class="sourceLine" id="cb109-12" data-line-number="12"><span class="co">##  8        2.6</span></a>
<a class="sourceLine" id="cb109-13" data-line-number="13"><span class="co">##  9        2.7</span></a>
<a class="sourceLine" id="cb109-14" data-line-number="14"><span class="co">## 10        2.3</span></a>
<a class="sourceLine" id="cb109-15" data-line-number="15"><span class="co">## 11       NA  </span></a>
<a class="sourceLine" id="cb109-16" data-line-number="16"><span class="co">## 12       NA</span></a>
<a class="sourceLine" id="cb109-17" data-line-number="17">unemp_tbl[<span class="dv">10</span>,]</a>
<a class="sourceLine" id="cb109-18" data-line-number="18"><span class="co">## # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb109-19" data-line-number="19"><span class="co">##   unemp_rate month   above_avg</span></a>
<a class="sourceLine" id="cb109-20" data-line-number="20"><span class="co">##        &lt;dbl&gt; &lt;chr&gt;   &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb109-21" data-line-number="21"><span class="co">## 1        2.3 October FALSE</span></a></code></pre></div>
<p>To replicate the above tidyverse example we would provide the indexes 10 and 1 respectively.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">unemp_tbl[<span class="dv">10</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="co">## # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="co">##   unemp_rate</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="co">##        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb110-5" data-line-number="5"><span class="co">## 1        2.3</span></a></code></pre></div>
<p>This is great, we’ve rewritten our tidyverse code in base R. But, just like the tidyverse code, we maintain the tibble data structure. This is because when we use a single bracket, it maintains the data structure of the object we are selecting from. If we wrap our brackets in another set of bracket, we are returned the an object of the same class as the underlying object.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">unemp_tbl[[<span class="dv">10</span>,<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="co">## [1] 2.3</span></a></code></pre></div>
<p>What that code is doing is narrowing the tibble down to a single column with a single row index and then extracting the underlying vector (the second bracket). To extract the underlying vector using the tidyverse, we can use the function <code>dplyr::pull()</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">unemp_tbl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="st">  </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="co">## [1] 2.3</span></a></code></pre></div>
<p>Now this brings us to the second-most fundamental structure in R: the list. Yes, second-most fundamental. I’ve been keeping a secret from you. Data frames are actually just lists in disguise. To prove it, I will remove the class from <code>unemp_tbl</code> and return the class of that unclassed object.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">unclass</span>(unemp_tbl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="st">  </span><span class="kw">class</span>()</a>
<a class="sourceLine" id="cb113-3" data-line-number="3"><span class="co">## [1] &quot;list&quot;</span></a></code></pre></div>
<p>That is right, data frames are actually just lists disguised as rectangles.</p>
</div>
<div id="lists" class="section level2">
<h2><span class="header-section-number">10.3</span> Lists</h2>
<p>There is a good chance that you will not have to interact with them too often That doesn’t mean you shouldn’t know how to when that time comes.</p>
<p>Lists are generally the most flexible object type in R. Unlike vectors and data frames lists do not impose any structure on the storage of our data.</p>
<p>The most simple lists may resemble something like a vector.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw">list</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>)</a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3"><span class="co">## [1] &quot;Jan&quot;</span></a>
<a class="sourceLine" id="cb114-4" data-line-number="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb114-5" data-line-number="5"><span class="co">## [[2]]</span></a>
<a class="sourceLine" id="cb114-6" data-line-number="6"><span class="co">## [1] &quot;Feb&quot;</span></a>
<a class="sourceLine" id="cb114-7" data-line-number="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb114-8" data-line-number="8"><span class="co">## [[3]]</span></a>
<a class="sourceLine" id="cb114-9" data-line-number="9"><span class="co">## [1] &quot;Mar&quot;</span></a></code></pre></div>
<p>Notice how this prints differently than</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Feb&quot;</span>, <span class="st">&quot;Mar&quot;</span>)</a>
<a class="sourceLine" id="cb115-2" data-line-number="2"><span class="co">## [1] &quot;Jan&quot; &quot;Feb&quot; &quot;Mar&quot;</span></a></code></pre></div>
<p>Each element of a list is self-contained. I think of lists somewhat like shipping containers where each element is its own container and all components of each element are together. We can include any type of R object in a list. For example, we can include the <code>unemp_tbl</code> and associated vectors.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1">l &lt;-<span class="st"> </span><span class="kw">list</span>(unemp_tbl, unemp, month.name)</a></code></pre></div>
<p>We can view the structure of the list to get an idea of what is actually contained by that list.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">str</span>(l)</a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="co">## List of 3</span></a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="co">##  $ :Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    12 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb117-4" data-line-number="4"><span class="co">##   ..$ unemp_rate: num [1:12] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3 ...</span></a>
<a class="sourceLine" id="cb117-5" data-line-number="5"><span class="co">##   ..$ month     : chr [1:12] &quot;January&quot; &quot;February&quot; &quot;March&quot; &quot;April&quot; ...</span></a>
<a class="sourceLine" id="cb117-6" data-line-number="6"><span class="co">##   ..$ above_avg : logi [1:12] TRUE TRUE TRUE FALSE TRUE TRUE ...</span></a>
<a class="sourceLine" id="cb117-7" data-line-number="7"><span class="co">##  $ : num [1:12] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3 ...</span></a>
<a class="sourceLine" id="cb117-8" data-line-number="8"><span class="co">##  $ : chr [1:12] &quot;January&quot; &quot;February&quot; &quot;March&quot; &quot;April&quot; ...</span></a></code></pre></div>
<p>The structure of <code>l</code> shows us that the first element is a tibble (has class <code>tbl_df</code>), and the other elements are numeric and character vectors respectively.</p>
<p>Because of this flexibility there are not predetermined dimensions that we can specify to our brackets. Like extracting the underlying vector value from a data frame we have to use <code>[[</code> for indexing. I like to think of <code>[</code> as walking up to the storage container and <code>[[</code> as actually opening it up and going inside. To get a sense of the difference lets look at the <code>unemp</code> vector.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">l[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="co">## [[1]]</span></a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3  NA  NA</span></a>
<a class="sourceLine" id="cb118-4" data-line-number="4"><span class="kw">class</span>(l[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb118-5" data-line-number="5"><span class="co">## [1] &quot;list&quot;</span></a></code></pre></div>
<p>When using the single bracket we are just selecting the first element of the list which is why we are returned another list.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">l[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb119-2" data-line-number="2"><span class="co">##  [1] 3.2 2.8 2.8 2.4 2.8 2.9 2.7 2.6 2.7 2.3  NA  NA</span></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="kw">class</span>(l[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb119-4" data-line-number="4"><span class="co">## [1] &quot;numeric&quot;</span></a></code></pre></div>
<p>When we use the double bracket we are going inside of the container and actually plucking that element out of the list. Once you have plucked out that element, we can again use another set of brackets to subset that item. To grab the tenth row and first column of the <code>unemp_tbl</code> inside of <code>l</code> we can write.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">l[[<span class="dv">1</span>]][[<span class="dv">10</span>,<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="co">## [1] 2.3</span></a></code></pre></div>
<p>Now that we know that data frames are lists we can actually extract the underlying vectors using <code>[[</code> as well as <code>$</code>. We can get the tenth row and first column a number of ways.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="co"># subsetting the data frame</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2">l[[<span class="dv">1</span>]][[<span class="dv">10</span>,<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="co">## [1] 2.3</span></a>
<a class="sourceLine" id="cb121-4" data-line-number="4"></a>
<a class="sourceLine" id="cb121-5" data-line-number="5"><span class="co"># grabbing the first vector then position</span></a>
<a class="sourceLine" id="cb121-6" data-line-number="6">l[[<span class="dv">1</span>]][[<span class="dv">1</span>]][<span class="dv">10</span>]</a>
<a class="sourceLine" id="cb121-7" data-line-number="7"><span class="co">## [1] 2.3</span></a>
<a class="sourceLine" id="cb121-8" data-line-number="8"></a>
<a class="sourceLine" id="cb121-9" data-line-number="9"><span class="co"># grabbing the vector by name then position</span></a>
<a class="sourceLine" id="cb121-10" data-line-number="10">l[[<span class="dv">1</span>]]<span class="op">$</span>unemp_rate[<span class="dv">10</span>]</a>
<a class="sourceLine" id="cb121-11" data-line-number="11"><span class="co">## [1] 2.3</span></a></code></pre></div>
<p>Frankly all of these brackets can get a little messy. The tidyverse package <code>purrr</code> has a super handy function called <code>pluck()</code> which handles all of these brackets for us. <code>purrr::pluck()</code> is meant for flexible indexing into data structures (documentation).</p>
<p><code>pluck()</code> works by first providing the object that you’d like to index—again, notice the data first emphasis—and then providing the position of the element you would like to pluck out of the object. Generally, I will use <code>pluck()</code> when possible. By doing so the code becomes more readable and adheres to a single style more thoroughly.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">purrr<span class="op">::</span><span class="kw">pluck</span>(l, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb122-2" data-line-number="2"><span class="co">## [1] 2.3</span></a></code></pre></div>
<p>Congratulations! You made it to the end of this exceptionally dense chapter. You may feel a little overwhlemed and that is to be expected. Nonetheless you should be proud! I have a few more asks of you before you move on.</p>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Drink some water</li>
<li>Move around a bit and shake it out</li>
<li>Create a list with the vectors <code>unemp</code>, <code>month.name</code>, and <code>avg_unemp</code>.</li>
<li>Recreate the <code>unemp_tbl</code> but referencing the list elements</li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb123-2" data-line-number="2"></a>
<a class="sourceLine" id="cb123-3" data-line-number="3">unemp_l &lt;-<span class="st"> </span><span class="kw">list</span>(unemp, month.name, avg_unemp)</a>
<a class="sourceLine" id="cb123-4" data-line-number="4"></a>
<a class="sourceLine" id="cb123-5" data-line-number="5"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb123-6" data-line-number="6">  <span class="dt">unemp_rate =</span> <span class="kw">pluck</span>(unemp_l, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb123-7" data-line-number="7">  <span class="dt">month =</span> <span class="kw">pluck</span>(unemp_l, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb123-8" data-line-number="8">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">above_avg =</span> unemp_rate <span class="op">&gt;</span><span class="st"> </span><span class="kw">pluck</span>(unemp_l, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb123-10" data-line-number="10"><span class="co">## # A tibble: 12 x 3</span></a>
<a class="sourceLine" id="cb123-11" data-line-number="11"><span class="co">##    unemp_rate month     above_avg</span></a>
<a class="sourceLine" id="cb123-12" data-line-number="12"><span class="co">##         &lt;dbl&gt; &lt;chr&gt;     &lt;lgl&gt;    </span></a>
<a class="sourceLine" id="cb123-13" data-line-number="13"><span class="co">##  1        3.2 January   TRUE     </span></a>
<a class="sourceLine" id="cb123-14" data-line-number="14"><span class="co">##  2        2.8 February  TRUE     </span></a>
<a class="sourceLine" id="cb123-15" data-line-number="15"><span class="co">##  3        2.8 March     TRUE     </span></a>
<a class="sourceLine" id="cb123-16" data-line-number="16"><span class="co">##  4        2.4 April     FALSE    </span></a>
<a class="sourceLine" id="cb123-17" data-line-number="17"><span class="co">##  5        2.8 May       TRUE     </span></a>
<a class="sourceLine" id="cb123-18" data-line-number="18"><span class="co">##  6        2.9 June      TRUE     </span></a>
<a class="sourceLine" id="cb123-19" data-line-number="19"><span class="co">##  7        2.7 July      FALSE    </span></a>
<a class="sourceLine" id="cb123-20" data-line-number="20"><span class="co">##  8        2.6 August    FALSE    </span></a>
<a class="sourceLine" id="cb123-21" data-line-number="21"><span class="co">##  9        2.7 September FALSE    </span></a>
<a class="sourceLine" id="cb123-22" data-line-number="22"><span class="co">## 10        2.3 October   FALSE    </span></a>
<a class="sourceLine" id="cb123-23" data-line-number="23"><span class="co">## 11       NA   November  NA       </span></a>
<a class="sourceLine" id="cb123-24" data-line-number="24"><span class="co">## 12       NA   December  NA</span></a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualizing-trends-and-relationships.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["urban-commons-toolkit.pdf", "urban-commons-toolkit.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
