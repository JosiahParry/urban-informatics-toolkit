<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Creating new measures | Urban Informatics Toolkit</title>
  <meta name="description" content="A hands on introduction approach to analyzing the urban Commons." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Creating new measures | Urban Informatics Toolkit" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A hands on introduction approach to analyzing the urban Commons." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Creating new measures | Urban Informatics Toolkit" />
  
  <meta name="twitter:description" content="A hands on introduction approach to analyzing the urban Commons." />
  

<meta name="author" content="Josiah Parry" />


<meta name="date" content="2020-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-pipe.html"/>
<link rel="next" href="data-structures.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Urban Informatics Toolkit</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i><b>1.1</b> Structure of the book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#considerations"><i class="fa fa-check"></i><b>1.2</b> Considerations</a></li>
</ul></li>
<li class="part"><span><b>I Foundations of Urban Informatics</b></span></li>
<li class="chapter" data-level="2" data-path="the-utility-and-danger-of-big-data.html"><a href="the-utility-and-danger-of-big-data.html"><i class="fa fa-check"></i><b>2</b> The Utility and Danger of Big Data</a></li>
<li class="chapter" data-level="3" data-path="data-in-the-municipal-context.html"><a href="data-in-the-municipal-context.html"><i class="fa fa-check"></i><b>3</b> Data in the municipal context</a></li>
<li class="chapter" data-level="4" data-path="approaches-to-and-schools-of-urban-informatics.html"><a href="approaches-to-and-schools-of-urban-informatics.html"><i class="fa fa-check"></i><b>4</b> Approaches to and Schools of Urban Informatics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="approaches-to-and-schools-of-urban-informatics.html"><a href="approaches-to-and-schools-of-urban-informatics.html#scientific-approaches"><i class="fa fa-check"></i><b>4.1</b> Scientific approaches</a></li>
<li class="chapter" data-level="4.2" data-path="approaches-to-and-schools-of-urban-informatics.html"><a href="approaches-to-and-schools-of-urban-informatics.html#the-chicago-school"><i class="fa fa-check"></i><b>4.2</b> The Chicago School</a></li>
<li class="chapter" data-level="4.3" data-path="approaches-to-and-schools-of-urban-informatics.html"><a href="approaches-to-and-schools-of-urban-informatics.html#complexity-and-santa-fe-institute"><i class="fa fa-check"></i><b>4.3</b> Complexity and Santa Fe Institute</a></li>
<li class="chapter" data-level="4.4" data-path="approaches-to-and-schools-of-urban-informatics.html"><a href="approaches-to-and-schools-of-urban-informatics.html#a-hybrid-approach"><i class="fa fa-check"></i><b>4.4</b> A Hybrid Approach</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ecometrics.html"><a href="ecometrics.html"><i class="fa fa-check"></i><b>5</b> Ecometrics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ecometrics.html"><a href="ecometrics.html#broken-windows-theory"><i class="fa fa-check"></i><b>5.1</b> Broken Windows Theory</a></li>
<li class="chapter" data-level="5.2" data-path="ecometrics.html"><a href="ecometrics.html#quantifying-disorder"><i class="fa fa-check"></i><b>5.2</b> Quantifying Disorder</a></li>
</ul></li>
<li class="part"><span><b>II Toolkit Foundations</b></span></li>
<li class="chapter" data-level="6" data-path="the-basics.html"><a href="the-basics.html"><i class="fa fa-check"></i><b>6</b> The basics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-basics.html"><a href="the-basics.html#what-is-r-and-why-do-i-care"><i class="fa fa-check"></i><b>6.1</b> What is R and why do I care?</a></li>
<li class="chapter" data-level="6.2" data-path="the-basics.html"><a href="the-basics.html#the-rstudio-ide"><i class="fa fa-check"></i><b>6.2</b> The RStudio IDE</a></li>
<li class="chapter" data-level="6.3" data-path="the-basics.html"><a href="the-basics.html#installing-r-rstudio"><i class="fa fa-check"></i><b>6.3</b> Installing R &amp; RStudio</a></li>
<li class="chapter" data-level="6.4" data-path="the-basics.html"><a href="the-basics.html#preventative-care"><i class="fa fa-check"></i><b>6.4</b> Preventative Care</a></li>
<li class="chapter" data-level="6.5" data-path="the-basics.html"><a href="the-basics.html#before-we-embark"><i class="fa fa-check"></i><b>6.5</b> Before we embark</a></li>
<li class="chapter" data-level="6.6" data-path="the-basics.html"><a href="the-basics.html#getting-help"><i class="fa fa-check"></i><b>6.6</b> Getting Help</a></li>
<li class="chapter" data-level="6.7" data-path="the-basics.html"><a href="the-basics.html#reminders"><i class="fa fa-check"></i><b>6.7</b> Reminders</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html"><i class="fa fa-check"></i><b>7</b> R as a calculator</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#arithmetic-operators"><i class="fa fa-check"></i><b>7.1</b> Arithmetic Operators</a></li>
<li class="chapter" data-level="7.2" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#variable-assignment"><i class="fa fa-check"></i><b>7.2</b> Variable assignment</a></li>
<li class="chapter" data-level="7.3" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#functions"><i class="fa fa-check"></i><b>7.3</b> Functions</a></li>
<li class="chapter" data-level="7.4" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#extensions-to-r"><i class="fa fa-check"></i><b>7.4</b> Extensions to R</a></li>
<li class="chapter" data-level="7.5" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#loading-packages"><i class="fa fa-check"></i><b>7.5</b> Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="whats-next.html"><a href="whats-next.html"><i class="fa fa-check"></i><b>8</b> What’s next?</a></li>
<li class="chapter" data-level="9" data-path="reading-data.html"><a href="reading-data.html"><i class="fa fa-check"></i><b>9</b> Reading data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="reading-data.html"><a href="reading-data.html#background"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="reading-data.html"><a href="reading-data.html#actually-reading-data"><i class="fa fa-check"></i><b>9.2</b> Actually Reading Data</a></li>
<li class="chapter" data-level="9.3" data-path="reading-data.html"><a href="reading-data.html#other-common-data-formats"><i class="fa fa-check"></i><b>9.3</b> Other common data formats</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exploratory-visual-analysis.html"><a href="exploratory-visual-analysis.html"><i class="fa fa-check"></i><b>10</b> Exploratory Visual Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exploratory-visual-analysis.html"><a href="exploratory-visual-analysis.html#the-american-community-survey"><i class="fa fa-check"></i><b>10.1</b> The American Community Survey</a></li>
<li class="chapter" data-level="10.2" data-path="exploratory-visual-analysis.html"><a href="exploratory-visual-analysis.html#a-first-visualization"><i class="fa fa-check"></i><b>10.2</b> A first visualization</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html"><i class="fa fa-check"></i><b>11</b> General data manipulation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html#scenario"><i class="fa fa-check"></i><b>11.1</b> Scenario</a></li>
<li class="chapter" data-level="11.2" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html#getting-physical-with-the-data"><i class="fa fa-check"></i><b>11.2</b> Getting physical with the data</a></li>
<li class="chapter" data-level="11.3" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html#selecting-rows"><i class="fa fa-check"></i><b>11.3</b> Selecting Rows</a></li>
<li class="chapter" data-level="11.4" data-path="general-data-manipulation.html"><a href="general-data-manipulation.html#revisiting-commmuting"><i class="fa fa-check"></i><b>11.4</b> Revisiting commmuting</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="thats-too-much-data.html"><a href="thats-too-much-data.html"><i class="fa fa-check"></i><b>12</b> That’s <em>too much</em> data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="thats-too-much-data.html"><a href="thats-too-much-data.html#filtering"><i class="fa fa-check"></i><b>12.1</b> <code>filter()</code>ing</a></li>
<li class="chapter" data-level="12.2" data-path="thats-too-much-data.html"><a href="thats-too-much-data.html#logical-operators"><i class="fa fa-check"></i><b>12.2</b> Logical operators</a></li>
<li class="chapter" data-level="12.3" data-path="thats-too-much-data.html"><a href="thats-too-much-data.html#defining-the-greater-boston-area"><i class="fa fa-check"></i><b>12.3</b> Defining the Greater Boston Area</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>13</b> The pipe <code>%&gt;%</code></a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-pipe.html"><a href="the-pipe.html#applying-the-pipe."><i class="fa fa-check"></i><b>13.1</b> Applying the pipe.</a></li>
<li class="chapter" data-level="13.2" data-path="the-pipe.html"><a href="the-pipe.html#revisiting-our-scenario"><i class="fa fa-check"></i><b>13.2</b> Revisiting our scenario</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="creating-new-measures.html"><a href="creating-new-measures.html"><i class="fa fa-check"></i><b>14</b> Creating new measures</a></li>
<li class="chapter" data-level="15" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>15</b> Data Structures</a>
<ul>
<li class="chapter" data-level="15.1" data-path="data-structures.html"><a href="data-structures.html#atomic-vectors"><i class="fa fa-check"></i><b>15.1</b> Atomic Vectors</a></li>
<li class="chapter" data-level="15.2" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>15.2</b> Data Frames</a></li>
<li class="chapter" data-level="15.3" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>15.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>16</b> Summary statistics</a></li>
<li class="chapter" data-level="17" data-path="summarizing-the-tidy-way.html"><a href="summarizing-the-tidy-way.html"><i class="fa fa-check"></i><b>17</b> Summarizing the tidy way</a></li>
<li class="chapter" data-level="18" data-path="toolkit-review.html"><a href="toolkit-review.html"><i class="fa fa-check"></i><b>18</b> Toolkit review</a></li>
<li class="part"><span><b>III Vizualization Strategies</b></span></li>
<li class="chapter" data-level="19" data-path="layered-i.html"><a href="layered-i.html"><i class="fa fa-check"></i><b>19</b> Grammer of layered graphics I</a>
<ul>
<li class="chapter" data-level="19.1" data-path="layered-i.html"><a href="layered-i.html#the-grammar-of-layered-graphics"><i class="fa fa-check"></i><b>19.1</b> The Grammar of Layered Graphics</a></li>
<li class="chapter" data-level="19.2" data-path="layered-i.html"><a href="layered-i.html#layers-and-defaults"><i class="fa fa-check"></i><b>19.2</b> Layers and defaults</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="visualizing-trends-and-relationships.html"><a href="visualizing-trends-and-relationships.html"><i class="fa fa-check"></i><b>20</b> Visualizing Trends and Relationships</a>
<ul>
<li class="chapter" data-level="20.1" data-path="visualizing-trends-and-relationships.html"><a href="visualizing-trends-and-relationships.html#univariate-visualizations"><i class="fa fa-check"></i><b>20.1</b> Univariate visualizations</a></li>
<li class="chapter" data-level="20.2" data-path="visualizing-trends-and-relationships.html"><a href="visualizing-trends-and-relationships.html#bivariate-visualizations"><i class="fa fa-check"></i><b>20.2</b> Bivariate visualizations</a></li>
<li class="chapter" data-level="20.3" data-path="visualizing-trends-and-relationships.html"><a href="visualizing-trends-and-relationships.html#review"><i class="fa fa-check"></i><b>20.3</b> Review:</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="grammer-of-layered-graphics-ii.html"><a href="grammer-of-layered-graphics-ii.html"><i class="fa fa-check"></i><b>21</b> Grammer of layered graphics II</a>
<ul>
<li class="chapter" data-level="21.1" data-path="grammer-of-layered-graphics-ii.html"><a href="grammer-of-layered-graphics-ii.html#scales"><i class="fa fa-check"></i><b>21.1</b> Scales</a></li>
<li class="chapter" data-level="21.2" data-path="grammer-of-layered-graphics-ii.html"><a href="grammer-of-layered-graphics-ii.html#coordinates"><i class="fa fa-check"></i><b>21.2</b> Coordinates</a></li>
<li class="chapter" data-level="21.3" data-path="grammer-of-layered-graphics-ii.html"><a href="grammer-of-layered-graphics-ii.html#facets"><i class="fa fa-check"></i><b>21.3</b> Facets</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="visualizing-beyond-2-dimensions.html"><a href="visualizing-beyond-2-dimensions.html"><i class="fa fa-check"></i><b>22</b> Visualizing beyond 2-dimensions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="visualizing-beyond-2-dimensions.html"><a href="visualizing-beyond-2-dimensions.html#color"><i class="fa fa-check"></i><b>22.1</b> Color</a></li>
<li class="chapter" data-level="22.2" data-path="visualizing-beyond-2-dimensions.html"><a href="visualizing-beyond-2-dimensions.html#shape-and-size"><i class="fa fa-check"></i><b>22.2</b> Shape and Size</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="visualizing-through-time.html"><a href="visualizing-through-time.html"><i class="fa fa-check"></i><b>23</b> Visualizing through time</a></li>
<li class="chapter" data-level="24" data-path="visualization-review.html"><a href="visualization-review.html"><i class="fa fa-check"></i><b>24</b> Visualization Review</a></li>
<li class="part"><span><b>IV More than hammer and nails</b></span></li>
<li class="chapter" data-level="25" data-path="multiple-data-sets.html"><a href="multiple-data-sets.html"><i class="fa fa-check"></i><b>25</b> Multiple data sets</a>
<ul>
<li class="chapter" data-level="25.1" data-path="multiple-data-sets.html"><a href="multiple-data-sets.html#exercise-2"><i class="fa fa-check"></i><b>25.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="spatial-analysis.html"><a href="spatial-analysis.html"><i class="fa fa-check"></i><b>26</b> Spatial Analysis</a>
<ul>
<li class="chapter" data-level="26.1" data-path="spatial-analysis.html"><a href="spatial-analysis.html#types-of-spatial-data"><i class="fa fa-check"></i><b>26.1</b> Types of spatial data</a></li>
<li class="chapter" data-level="26.2" data-path="spatial-analysis.html"><a href="spatial-analysis.html#working-with-spatial-data"><i class="fa fa-check"></i><b>26.2</b> Working with spatial data</a></li>
<li class="chapter" data-level="26.3" data-path="spatial-analysis.html"><a href="spatial-analysis.html#creating-simple-features-from-a-tibble"><i class="fa fa-check"></i><b>26.3</b> Creating simple features from a tibble</a></li>
<li class="chapter" data-level="26.4" data-path="spatial-analysis.html"><a href="spatial-analysis.html#plotting-sf-objects-with-ggplot"><i class="fa fa-check"></i><b>26.4</b> Plotting sf objects with ggplot</a></li>
<li class="chapter" data-level="26.5" data-path="spatial-analysis.html"><a href="spatial-analysis.html#connecting-points-to-polygons"><i class="fa fa-check"></i><b>26.5</b> Connecting points to polygons</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/josiahparry/urban-informatics-toolkit" target="blank">GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Urban Informatics Toolkit</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="creating-new-measures" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Creating new measures</h1>
<p>It’s been a week now and the non-profit has finally emailed you back. They were ecstatic with what you provided but it begat even more questions for them. They indicated that while the median household income data was very intruiging, that would be difficult for them to report on. As such, they would like you to report on the income quintiles as well. Moreover, they also would like to see the rate of Bachelor’s and Master’s degrees combined into one general educational attainment variable.</p>
<p>This poses some challenges for you. You know <em>what</em> is being asked, just not necessarily <em>how</em> to achieve that from R. To accomplish this we’re going to have to learn how to use the <code>dplyr::mutate()</code> function. For the sake of example, let’s select only the columns that we’re going to need and make a tibble called <code>df</code> just to work with.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="creating-new-measures.html#cb115-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb115-2"><a href="creating-new-measures.html#cb115-2"></a></span>
<span id="cb115-3"><a href="creating-new-measures.html#cb115-3"></a>commute &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/gba_commute.csv&quot;</span>)</span>
<span id="cb115-4"><a href="creating-new-measures.html#cb115-4"></a>df &lt;-<span class="st"> </span><span class="kw">select</span>(commute, med_house_income, bach, master)</span>
<span id="cb115-5"><a href="creating-new-measures.html#cb115-5"></a></span>
<span id="cb115-6"><a href="creating-new-measures.html#cb115-6"></a>df</span>
<span id="cb115-7"><a href="creating-new-measures.html#cb115-7"></a><span class="co">#&gt; # A tibble: 648 x 3</span></span>
<span id="cb115-8"><a href="creating-new-measures.html#cb115-8"></a><span class="co">#&gt;    med_house_income  bach master</span></span>
<span id="cb115-9"><a href="creating-new-measures.html#cb115-9"></a><span class="co">#&gt;               &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb115-10"><a href="creating-new-measures.html#cb115-10"></a><span class="co">#&gt;  1            75085 0.188 0.100 </span></span>
<span id="cb115-11"><a href="creating-new-measures.html#cb115-11"></a><span class="co">#&gt;  2           132727 0.400 0.130 </span></span>
<span id="cb115-12"><a href="creating-new-measures.html#cb115-12"></a><span class="co">#&gt;  3           110694 0.317 0.139 </span></span>
<span id="cb115-13"><a href="creating-new-measures.html#cb115-13"></a><span class="co">#&gt;  4           109125 0.322 0.144 </span></span>
<span id="cb115-14"><a href="creating-new-measures.html#cb115-14"></a><span class="co">#&gt;  5            76746 0.177 0.0742</span></span>
<span id="cb115-15"><a href="creating-new-measures.html#cb115-15"></a><span class="co">#&gt;  6           138700 0.310 0.207 </span></span>
<span id="cb115-16"><a href="creating-new-measures.html#cb115-16"></a><span class="co">#&gt;  7           104673 0.247 0.149 </span></span>
<span id="cb115-17"><a href="creating-new-measures.html#cb115-17"></a><span class="co">#&gt;  8            73191 0.300 0.126 </span></span>
<span id="cb115-18"><a href="creating-new-measures.html#cb115-18"></a><span class="co">#&gt;  9           121488 0.198 0.140 </span></span>
<span id="cb115-19"><a href="creating-new-measures.html#cb115-19"></a><span class="co">#&gt; 10            99358 0.348 0.151 </span></span>
<span id="cb115-20"><a href="creating-new-measures.html#cb115-20"></a><span class="co">#&gt; # … with 638 more rows</span></span></code></pre></div>
<p><code>mutate()</code> is a function that let’s us create or modify variables. The arguments for <code>mutate()</code> are the same as those for <code>select()</code>—<code>.data</code> and <code>...</code>. In the case of <code>mutate()</code> dots works a littble bit differently. After indicating our data, we create columns by specifying a name-value pair. More simply the names of our arguments will be the name of the columns that we are creating. The value is any expression. For example we could use <code>mutate(df, one = 1)</code> to create a column called <code>one</code> with the value of 1. When using mutate, however, the result from the expression needs to be either only <em>one</em> value, or as many values as there are rows.</p>
<p>If we take our <code>df</code>, we can add the columns <code>bach</code> and <code>master</code> together to create a new column called <code>edu_attain</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="creating-new-measures.html#cb116-1"></a><span class="kw">mutate</span>(df, <span class="dt">edu_attain =</span> bach <span class="op">+</span><span class="st"> </span>master)</span>
<span id="cb116-2"><a href="creating-new-measures.html#cb116-2"></a><span class="co">#&gt; # A tibble: 648 x 4</span></span>
<span id="cb116-3"><a href="creating-new-measures.html#cb116-3"></a><span class="co">#&gt;    med_house_income  bach master edu_attain</span></span>
<span id="cb116-4"><a href="creating-new-measures.html#cb116-4"></a><span class="co">#&gt;               &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb116-5"><a href="creating-new-measures.html#cb116-5"></a><span class="co">#&gt;  1            75085 0.188 0.100       0.288</span></span>
<span id="cb116-6"><a href="creating-new-measures.html#cb116-6"></a><span class="co">#&gt;  2           132727 0.400 0.130       0.531</span></span>
<span id="cb116-7"><a href="creating-new-measures.html#cb116-7"></a><span class="co">#&gt;  3           110694 0.317 0.139       0.456</span></span>
<span id="cb116-8"><a href="creating-new-measures.html#cb116-8"></a><span class="co">#&gt;  4           109125 0.322 0.144       0.466</span></span>
<span id="cb116-9"><a href="creating-new-measures.html#cb116-9"></a><span class="co">#&gt;  5            76746 0.177 0.0742      0.251</span></span>
<span id="cb116-10"><a href="creating-new-measures.html#cb116-10"></a><span class="co">#&gt;  6           138700 0.310 0.207       0.516</span></span>
<span id="cb116-11"><a href="creating-new-measures.html#cb116-11"></a><span class="co">#&gt;  7           104673 0.247 0.149       0.396</span></span>
<span id="cb116-12"><a href="creating-new-measures.html#cb116-12"></a><span class="co">#&gt;  8            73191 0.300 0.126       0.426</span></span>
<span id="cb116-13"><a href="creating-new-measures.html#cb116-13"></a><span class="co">#&gt;  9           121488 0.198 0.140       0.338</span></span>
<span id="cb116-14"><a href="creating-new-measures.html#cb116-14"></a><span class="co">#&gt; 10            99358 0.348 0.151       0.499</span></span>
<span id="cb116-15"><a href="creating-new-measures.html#cb116-15"></a><span class="co">#&gt; # … with 638 more rows</span></span></code></pre></div>
<p>We could even think about ways that we can check if some observations are above some specified income threshold.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="creating-new-measures.html#cb117-1"></a><span class="kw">mutate</span>(df, <span class="dt">above_70k_inc =</span> med_house_income <span class="op">&gt;</span><span class="st"> </span><span class="dv">80000</span>) </span>
<span id="cb117-2"><a href="creating-new-measures.html#cb117-2"></a><span class="co">#&gt; # A tibble: 648 x 4</span></span>
<span id="cb117-3"><a href="creating-new-measures.html#cb117-3"></a><span class="co">#&gt;    med_house_income  bach master above_70k_inc</span></span>
<span id="cb117-4"><a href="creating-new-measures.html#cb117-4"></a><span class="co">#&gt;               &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;        </span></span>
<span id="cb117-5"><a href="creating-new-measures.html#cb117-5"></a><span class="co">#&gt;  1            75085 0.188 0.100  FALSE        </span></span>
<span id="cb117-6"><a href="creating-new-measures.html#cb117-6"></a><span class="co">#&gt;  2           132727 0.400 0.130  TRUE         </span></span>
<span id="cb117-7"><a href="creating-new-measures.html#cb117-7"></a><span class="co">#&gt;  3           110694 0.317 0.139  TRUE         </span></span>
<span id="cb117-8"><a href="creating-new-measures.html#cb117-8"></a><span class="co">#&gt;  4           109125 0.322 0.144  TRUE         </span></span>
<span id="cb117-9"><a href="creating-new-measures.html#cb117-9"></a><span class="co">#&gt;  5            76746 0.177 0.0742 FALSE        </span></span>
<span id="cb117-10"><a href="creating-new-measures.html#cb117-10"></a><span class="co">#&gt;  6           138700 0.310 0.207  TRUE         </span></span>
<span id="cb117-11"><a href="creating-new-measures.html#cb117-11"></a><span class="co">#&gt;  7           104673 0.247 0.149  TRUE         </span></span>
<span id="cb117-12"><a href="creating-new-measures.html#cb117-12"></a><span class="co">#&gt;  8            73191 0.300 0.126  FALSE        </span></span>
<span id="cb117-13"><a href="creating-new-measures.html#cb117-13"></a><span class="co">#&gt;  9           121488 0.198 0.140  TRUE         </span></span>
<span id="cb117-14"><a href="creating-new-measures.html#cb117-14"></a><span class="co">#&gt; 10            99358 0.348 0.151  TRUE         </span></span>
<span id="cb117-15"><a href="creating-new-measures.html#cb117-15"></a><span class="co">#&gt; # … with 638 more rows</span></span></code></pre></div>
<p>This function is immensly useful and can be combined with almost any expression to create new data for us. Furthermore there are a number of handy functions built into dplyr that help us create new columns. Some of these are <code>case_when()</code>, <code>min_rank()</code>, and <code>ntile()</code> among others. You can always explore these with <code>?function_name()</code>. For our purposes, we will look at the use of <code>ntile()</code>.</p>
<p><code>ntile()</code> is a function that will calculate percentiles for us. Given a column of data, <code>x</code>, and a number of buckets, <code>n</code>, we can create a new column of ranks. In our case, we are interested in calculating the quintile of <code>med_house_income</code>. This means we can provide <code>med_house_income</code> and <code>n = 5</code> as arguments to <code>ntile()</code> to group our observations by quintile.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="creating-new-measures.html#cb118-1"></a><span class="kw">mutate</span>(df, <span class="dt">inc_quintile =</span> <span class="kw">ntile</span>(med_house_income, <span class="dv">5</span>))</span>
<span id="cb118-2"><a href="creating-new-measures.html#cb118-2"></a><span class="co">#&gt; # A tibble: 648 x 4</span></span>
<span id="cb118-3"><a href="creating-new-measures.html#cb118-3"></a><span class="co">#&gt;    med_house_income  bach master inc_quintile</span></span>
<span id="cb118-4"><a href="creating-new-measures.html#cb118-4"></a><span class="co">#&gt;               &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;        &lt;int&gt;</span></span>
<span id="cb118-5"><a href="creating-new-measures.html#cb118-5"></a><span class="co">#&gt;  1            75085 0.188 0.100             2</span></span>
<span id="cb118-6"><a href="creating-new-measures.html#cb118-6"></a><span class="co">#&gt;  2           132727 0.400 0.130             5</span></span>
<span id="cb118-7"><a href="creating-new-measures.html#cb118-7"></a><span class="co">#&gt;  3           110694 0.317 0.139             4</span></span>
<span id="cb118-8"><a href="creating-new-measures.html#cb118-8"></a><span class="co">#&gt;  4           109125 0.322 0.144             4</span></span>
<span id="cb118-9"><a href="creating-new-measures.html#cb118-9"></a><span class="co">#&gt;  5            76746 0.177 0.0742            2</span></span>
<span id="cb118-10"><a href="creating-new-measures.html#cb118-10"></a><span class="co">#&gt;  6           138700 0.310 0.207             5</span></span>
<span id="cb118-11"><a href="creating-new-measures.html#cb118-11"></a><span class="co">#&gt;  7           104673 0.247 0.149             4</span></span>
<span id="cb118-12"><a href="creating-new-measures.html#cb118-12"></a><span class="co">#&gt;  8            73191 0.300 0.126             2</span></span>
<span id="cb118-13"><a href="creating-new-measures.html#cb118-13"></a><span class="co">#&gt;  9           121488 0.198 0.140             5</span></span>
<span id="cb118-14"><a href="creating-new-measures.html#cb118-14"></a><span class="co">#&gt; 10            99358 0.348 0.151             4</span></span>
<span id="cb118-15"><a href="creating-new-measures.html#cb118-15"></a><span class="co">#&gt; # … with 638 more rows</span></span></code></pre></div>
<p>Now we can put everything together into one mutate call to create the new variables that were requested!</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="creating-new-measures.html#cb119-1"></a>updated_commute &lt;-<span class="st"> </span>commute <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-2"><a href="creating-new-measures.html#cb119-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">edu_attain =</span> bach <span class="op">+</span><span class="st"> </span>master, </span>
<span id="cb119-3"><a href="creating-new-measures.html#cb119-3"></a>         <span class="dt">inc_quintile =</span> <span class="kw">ntile</span>(med_house_income, <span class="dv">5</span>))</span></code></pre></div>
<p>As you have made these changes you can now write the data again to csv and share it. As this process becomes more and more iterative, it’s good to put <em>some</em> structure to the data so you have an idea of the history. One general practice that is good to get into is dating your files. So in this case I would label the file <code>yyyy-mm-dd-commute.csv</code>.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-pipe.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-structures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["urban-commons-toolkit.pdf", "urban-commons-toolkit.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
